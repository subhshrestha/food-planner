<p-dialog
  [header]="recipe()?.name || 'Recipe Details'"
  [(visible)]="visible"
  [modal]="true"
  [style]="{ width: '90vw', maxWidth: '600px' }"
  [draggable]="false"
  [resizable]="false"
  (onHide)="closeModal()"
>
  @if (recipe(); as r) {
    <div class="recipe-details">
      <!-- Recipe Image -->
      <img
        [src]="r.image"
        [alt]="r.name"
        class="w-full h-48 object-cover rounded-lg mb-4"
        (error)="onImageError($event)"
      />

      <!-- Time and Servings -->
      <div class="flex gap-4 mb-4 text-gray-600">
        <span class="flex items-center gap-2">
          <i class="pi pi-clock text-orange-500"></i>
          <span>Prep: {{ r.prepTime }} min</span>
        </span>
        <span class="flex items-center gap-2">
          <i class="pi pi-stopwatch text-orange-500"></i>
          <span>Cook: {{ r.cookTime }} min</span>
        </span>
        <span class="flex items-center gap-2">
          <i class="pi pi-users text-orange-500"></i>
          <span>Serves: {{ r.servings }}</span>
        </span>
      </div>

      <!-- Ingredients -->
      <div class="mb-6">
        <h4 class="text-lg font-semibold mb-3 text-gray-800">Ingredients</h4>
        <ul class="list-disc list-inside space-y-1">
          @for (ingredient of r.ingredients; track ingredient.name) {
            <li class="text-gray-700">
              {{ ingredient.quantity }} {{ ingredient.unit }}
              <span class="font-medium">{{ ingredient.name }}</span>
            </li>
          }
        </ul>
      </div>

      <!-- Instructions -->
      <div>
        <h4 class="text-lg font-semibold mb-3 text-gray-800">Instructions</h4>
        <ol class="list-decimal list-inside space-y-2">
          @for (line of getInstructionLines(); track $index) {
            <li class="text-gray-700">{{ line }}</li>
          }
        </ol>
      </div>
    </div>
  }

  <ng-template #footer>
    <p-button label="Close" icon="pi pi-times" (click)="closeModal()" />
  </ng-template>
</p-dialog>
